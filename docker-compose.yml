version: '3.8'

services:
  # unsure about starting the cli as a container
  # just ssh in manually?
  # cli:
  #   build: cli/.
  #   network_mode: host
  #   hostname: localhost
  #   stdin_open: true
  #   tty: true
  #   depends_on:
  #     - onos-controller

  mininet:
    build: mininet/.
    environment:
      - MN_FLAGS=
      - TOPO=/topologies/topo.py
    privileged: true
    network_mode: host
    hostname: localhost
    tty: true
    volumes:
      - ./mininet/topo.py:/topologies/topo.py
    depends_on:
      - onos-controller

  onos-controller:
    container_name: onos-controller
    image: ghcr.io/ng-cdi/demo-onos:2.6
    hostname: localhost
    ports:
      - 8101:8101
      - 8181:8181
      - 6633:6633
      - 6653:6653
      - 6640:6640
      - 9876:9876

  onos-reroute-api:
    container_name: onos-reroute-api
    image: ghcr.io/mavi0/onos-reroute-api:latest
    network_mode: host
    hostname: localhost
    tty: true
    volumes:
      - ./reroute-api/json:/reroute/json
    environment:
      - TERM=xterm-256color
